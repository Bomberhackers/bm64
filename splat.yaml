name: Bomberman 64 (USA)
basename: bm64
sha1: 8f9e1706b5ef0d51c3cbce4a024796f56420784a
options:
  compiler: IDO
  symbol_addrs_path: tools/symbol_addrs.txt
  target_path: baserom.decomp.z64
  basename: bm64
  base_path: .
  ld_script_path: bm64.ld
  platform: n64
  ld_legacy_generation: false
  detect_redundant_function_end: true
  ld_sections_allowlist:
    - .shstrtab
    - .mdebug
    - .mdebug.abi32
segments:
  - name: header
    type: header
    start: 0x00
    vram: 0
    exclusive_ram_id: code
    subsegments:
    - [0x0000, header, header]
  - name: boot
    type: code
    start: 0x0040
    vram: 0xA4000040
    subsegments:
    - [0x0040, asm, boot]
    - [0x0B70, bin, bootcode_font]
  - name: boot_code
    type: code
    bss_size: 0x0 # unknown
    start: 0x1000
    vram: 0x80000400
    exclusive_ram_id: code
    subsegments:
    - [0x1000, hasm, entry] # bootloader
    - [0x1050, c, set_zero_tlb]
    - [0x10D0, c] # DMA memory area?
    - [0x13F0, c]
    - [0x14B0, asm] # sched.c according to asserts
    - [0x2350, c] # main
    - [0x2630, asm]
    
    # start of libultra. first file might be our "overridden synsetvol" they also used in Hero.
    - [0x2650, asm,  libultra/audio/synstartvoiceparam]
    - [0x2740, hasm, libultra/os/maptlb]
    - [0x2800, asm,  libultra/io/pimgr]
    - [0x2990, asm,  libultra/os/createmesgqueue]
    - [0x29C0, asm,  libultra/os/recvmesg]
    - [0x2B00, asm,  libultra/io/pidma]
    - [0x2C10, asm,  libultra/os/yieldthread]
    - [0x2C60, hasm, libultra/os/writebackdcache]
    - [0x2CE0, hasm, libultra/os/invaldcache]
    - [0x2D90, hasm, libultra/os/invalicache]
    - [0x2E10, asm,  libultra/io/vimgr]
    - [0x3170, asm,  libultra/io/visetmode]
    - [0x31E0, asm,  libultra/io/viblack]
    - [0x3250, asm,  libultra/os/seteventmesg]
    - [0x32C0, asm,  libultra/io/visetevent]
    - [0x3330, asm,  libultra/os/createthread]
    - [0x3480, asm,  libultra/os/startthread]
    - [0x35D0, asm,  libultra/os/setintmask]
    - [0x3670, asm,  libultra/os/gettime]
    - [0x3700, asm,  libultra/os/sendmesg]
    - [0x3850, asm,  libultra/io/sptaskyielded]
    - [0x38D0, asm,  libultra/io/vigetcurrframebuf]
    - [0x3910, asm,  libultra/io/vigetnextframebuf]
    - [0x3950, asm,  libultra/io/viswapbuf]
    - [0x39A0, asm,  libultra/os/writebackdcacheall]
    - [0x39D0, asm,  libultra/io/sptask]
    - [0x3CC0, asm,  libultra/io/dpsetnextbuf]
    - [0x3D70, asm,  libultra/io/sptaskyield]
    - [0x3D90, asm,  libultra/os/unmaptlball]
    - [0x3DE0, asm,  libultra/os/initialize]
    - [0x4070, asm,  libultra/os/setthreadpri]
    - [0x4150, bin,  noppad_4150] # nop padding
    - [0x41B0, asm,  libultra/libc/sprintf]
    - [0x4230, asm,  libultra/os/virtualtophysical]
    - [0x42B0, asm,  libultra/os/jammesg]
    - [0x4400, asm,  libultra/os/stopthread]
    - [0x44C0, asm,  libultra/os/destroythread]
    - [0x45C0, asm,  libultra/os/getthreadpri]
    - [0x45E0, asm,  libultra/os/getthreadid]
    - [0x4600, asm,  libultra/os/settime]
    - [0x4630, asm,  libultra/os/settimer]
    - [0x4710, asm,  libultra/os/stoptimer]
    - [0x4800, hasm, libultra/os/getcount]
    - [0x4810, asm,  libultra/io/conteepprobe]
    - [0x4880, asm,  libultra/io/conteepread]
    - [0x4B80, asm,  libultra/io/conteepwrite]
    - [0x5060, asm,  libultra/io/conteeplongread]
    - [0x51A0, asm,  libultra/io/conteeplongwrite]
    - [0x52E0, asm]
    - [0x5900, hasm, libultra/os/getintmask]
    - [0x5960, asm,  libultra/os/getactivequeue]
    - [0x5970, asm,  libultra/io/vigetmode]
    - [0x59C0, asm,  libultra/io/vigetline]
    - [0x59D0, asm,  libultra/io/vigetfield]
    - [0x59F0, asm,  libultra/io/visetxscale]
    - [0x5B20, asm,  libultra/io/visetyscale]
    - [0x5B80, asm,  libultra/io/visetspecial]
    - [0x5D40, asm,  libultra/io/vifade]
    - [0x5DD0, asm,  libultra/io/aigetstat]
    - [0x5DE0, asm,  libultra/io/aigetlen]
    - [0x5DF0, asm,  libultra/io/aisetfreq]
    - [0x5F50, asm,  libultra/io/aisetnextbuf]
    - [0x6000, asm,  libultra/io/dpgetstat]
    - [0x6010, asm,  libultra/io/dpsetstat]
    - [0x6020, asm,  libultra/io/dpctr]
    - [0x6070, asm,  libultra/io/pigetstat]
    - [0x6080, asm] # unknown file
    - [0x6090, asm,  libultra/io/pirawwrite]
    - [0x60E0, asm,  libultra/io/pirawread]
    - [0x6140, asm,  libultra/io/pirawdma]
    - [0x6220, asm,  libultra/io/piwrite]
    - [0x6260, asm] # unknown file
    - [0x6660, asm,  libultra/io/contreaddata]
    - [0x68C0, asm,  libultra/io/contreset]
    - [0x6A40, asm,  libultra/io/contquery]
    - [0x6AF0, asm,  libultra/io/contsetch]
    - [0x6B60, asm,  libultra/libc/llcvt]
    - [0x6D70, asm]
    - [0x6D80, asm,  libultra/audio/sl]
    - [0x6E40, asm,  libultra/audio/copy]
    - [0x6EC0, asm,  libultra/audio/heapinit]
    - [0x6F00, asm,  libultra/audio/heapalloc]
    - [0x6F60, asm,  libultra/audio/heapcheck]
    - [0x6F70, asm,  libultra/audio/bnkf]
    - [0x71C0, asm,  libultra/audio/synthesizer]
    - [0x78A0, asm,  libultra/audio/syndelete]
    - [0x78B0, asm,  libultra/audio/synaddplayer]
    - [0x7900, asm,  libultra/audio/synremoveplayer]
    - [0x79A0, asm,  libultra/audio/synallocvoice]
    - [0x7BD0, asm,  libultra/audio/synfreevoice]
    - [0x7C80, asm,  libultra/audio/synstartvoice]
    - [0x7D10, asm,  libultra/audio/synstopvoice]
    - [0x7D90, asm,  libultra/audio/synsetvol]
    - [0x7E30, asm,  libultra/audio/synsetpitch]
    - [0x7EC0, asm,  libultra/audio/synsetpan]
    - [0x7F50, asm,  libultra/audio/synsetfxmix]
    - [0x7FF0, asm,  libultra/audio/synsetpriority]
    - [0x8000, asm,  libultra/audio/syngetpriority]
    - [0x8010, asm,  libultra/audio/synallocfx]
    - [0x80B0, asm,  libultra/audio/syngetfxref]
    - [0x8130, asm,  libultra/audio/synfreefx]
    - [0x8140, asm,  libultra/audio/synsetfxparam]
    - [0x8180, asm,  libultra/audio/event]
    - [0x84C0, asm,  libultra/audio/seq]
    - [0x8AE0, asm,  libultra/audio/cseq]
    - [0x95A0, asm,  libultra/audio/cents2ratio]
    - [0x95F0, asm,  libultra/audio/seqplayer]
    - [0xAF30, asm,  libultra/audio/seqpdelete]
    - [0xAF60, asm,  libultra/audio/seqpsetseq]
    - [0xAFA0, asm,  libultra/audio/seqpgetseq]
    - [0xAFB0, asm,  libultra/audio/seqpplay]
    - [0xAFE0, asm,  libultra/audio/seqpstop]
    - [0xB010, asm,  libultra/audio/seqpgetstate]
    - [0xB020, asm,  libultra/audio/seqpsetbank]
    - [0xB060, asm,  libultra/audio/seqpsettempo]
    - [0xB0D0, asm,  libultra/audio/seqpgettempo]
    - [0xB110, asm,  libultra/audio/seqpgetvol]
    - [0xB120, asm,  libultra/audio/seqpsetvol]
    - [0xB160, asm,  libultra/audio/seqploop]
    - [0xB1A0, asm,  libultra/audio/seqpsetprogram]
    - [0xB200, asm,  libultra/audio/seqpgetprogram]
    - [0xB290, asm,  libultra/audio/seqpsetfxmix]
    - [0xB2F0, asm,  libultra/audio/seqpgetfxmix]
    - [0xB310, asm,  libultra/audio/seqpsetchlvol]
    - [0xB370, asm,  libultra/audio/seqpgetchlvol]
    - [0xB390, asm,  libultra/audio/seqpsetpan]
    - [0xB3F0, asm,  libultra/audio/seqpgetpan]
    - [0xB410, asm,  libultra/audio/seqpsetpriority]
    - [0xB460, asm,  libultra/audio/seqpgetpriority]
    - [0xB480, asm]
    - [0xB4E0, asm]
    
    - [0xC710, asm]
    - [0xC740, asm]
    - [0xC780, asm]
    - [0xC790, asm]
    - [0xC800, asm]
    - [0xC840, asm]
    - [0xC8B0, asm]
    - [0xC900, asm]
    - [0xC940, asm]
    - [0xC9A0, asm]
    - [0xCA30, asm]
    - [0xCA90, asm]
    - [0xCAB0, asm]
    - [0xCB10, asm]
    - [0xCB30, asm]
    - [0xCB90, asm]
    - [0xCBB0, asm]
    - [0xCC00, asm]
    - [0xCC20, asm]
    - [0xD390, asm]
    - [0xD3C0, asm]
    - [0xD460, asm]
    
    - [0xD4D0, asm]
    - [0xD4E0, asm]
    - [0xD550, asm]
    - [0xD5A0, asm]
    - [0xD5F0, asm]
    - [0xD650, asm]
    - [0xD6B0, asm]
    - [0xD710, asm]
    - [0xD7A0, asm]
    - [0xD7C0, asm]
    - [0xEE90, asm]
    - [0xF050, asm]
    - [0xF660, asm]
    - [0xFB60, asm]
    - [0xFF10, asm]
    - [0x10010, asm]
    - [0x10380, asm]
    - [0x104D0, asm]
    - [0x10620, asm]
    - [0x11040, asm]
    - [0x112B0, asm]
    - [0x11510, asm]
    
    - [0x11600, asm]
    - [0x11700, asm]
    - [0x11800, asm]
    - [0x11A30, asm]
    - [0x12810, asm]
    - [0x12840, asm]
    - [0x12C40, asm]
    - [0x12D80, asm]
    - [0x12D90, asm]
    - [0x130F0, asm]
    - [0x13100, asm]
    - [0x13410, asm]
    - [0x13420, asm]
    - [0x13460, asm]
    - [0x134F0, asm]
    - [0x13520, asm]
    - [0x13550, asm]
    - [0x13570, asm]
    - [0x13620, asm]
    - [0x13680, asm]
    - [0x139E0, asm]
    
    - [0x146A0, asm]
    - [0x14740, asm]
    - [0x14800, asm]
    - [0x14810, asm]
    - [0x148D0, asm,  libultra/io/sirawdma]
    - [0x14980, asm]
    - [0x14B00, asm,  libultra/io/contramwrite]
    - [0x14E80, asm,  libultra/io/contramread]
    - [0x15210, asm]
    - [0x159E0, asm]
    - [0x16680, asm]
    - [0x16980, asm]
    - [0x175E0, asm]
    - [0x176F0, asm]
    - [0x18400, asm]
    - [0x18510, asm]
    - [0x19270, asm]
    - [0x192D0, asm]
    - [0x19320, asm]
    - [0x193C0, asm]
    - [0x19C40, asm]
    - [0x19C70, asm]
    - [0x19F10, asm]
    
    - [0x1A9D0, asm]
    - [0x1A9F0, asm]
    - [0x1AB80, data]

  - name: zerojump
    exclusive_ram_id: code
    type: code
    bss_size: 0x0 # unknown
    start: 0x1CBC0
    vram: 0x80042000
    subsegments:
    - [0x1CBC0, asm]
    - [0x1CC60, rodata]
    
  # not sure what this is yet
  - name: zerojump_after
    exclusive_ram_id: code
    type: bin
    bss_size: 0x0 # unknown
    start: 0x1CCF0
    vram: 0x80800000 # placeholder
    subsegments:
    - [0x1CCF0, bin] # some weird zero'd out area except 1 or 2 things

  - name: section_sizes
    exclusive_ram_id: code
    type: data
    bss_size: 0x0 # unknown
    start: 0x30000
    vram: 0x80024820
    subsegments:
    - [0x30000, data] # table of section sizes

  - name: overlay_sizes
    exclusive_ram_id: code
    type: data
    bss_size: 0x0 # unknown
    start: 0x30800
    vram: 0x8019B0D0
    subsegments:
    - [0x30800, data]
    - [0x31800, data]

  - name: main_code
    exclusive_ram_id: code
    type: code
    bss_size: 0x0 # unknown
    start: 0x40000
    vram: 0x80225800
    subsegments:
    - [0x40000, c] # Why is this -g?
    - [0x40040, c]
    - [0x40300, c]
    - [0x404C0, asm]
    - [0x40FB0, asm]
    - [0x412F0, asm]
    - [0x41FD0, asm]
    - [0x426E0, asm]
    - [0x47A80, asm]
    - [0x4DE50, asm]
    - [0x4ED50, asm]
    - [0x52270, asm]
    - [0x530C0, asm]
    - [0x53D70, asm]
    - [0x54BE0, asm]
    - [0x54E40, asm]
    - [0x5E090, asm]
    - [0x5E3F0, asm]
    - [0x6BBE0, asm]
    - [0x78CA0, asm]
    - [0x7B2D0, asm]
    - [0x7C4D0, asm]
    - [0x7D840, asm]
    - [0x80420, asm]
    - [0x80580, asm]
    - [0x85A10, asm]
    - [0x86680, asm]
    - [0x87190, asm]
    - [0x87730, asm]
    - [0x87D80, asm]
    - [0x93850, asm]
    - [0x96540, asm]
    - [0x995C0, asm]
    - [0x99F40, asm]
    - [0x9A5F0, asm]
    - [0x9BFD0, asm]
    - [0x9CAB0, asm]
    - [0xA2840, asm]
    - [0xA4860, asm]
    - [0xA4CE0, asm]
    - [0xAA580, asm]
    - [0xACA00, asm]
    - [0xAD3D0, asm]
    - [0xAFBF0, asm]
    - [0xB11F0, asm]
    - [0xB2410, asm]
    - [0xB2500, asm]
    - [0xB2530, asm]
    
  - name: main_code_2
    exclusive_ram_id: code
    type: code
    bss_size: 0x0 # unknown
    start: 0xB3B70
    vram: 0x80299370
    subsegments:
    - [0xB3B70, asm]
    - [0xB63F0, asm]
    - [0xB6680, asm]
    - [0xB7710, asm]
    - [0xB7720, asm]

  - name: pre_rsp_area
    exclusive_ram_id: code
    type: code
    bss_size: 0x0 # unknown
    start: 0xB7A50
    vram: 0x8029D250
    subsegments:
    - [0xB7A50, bin]

  - name: rsp_area
    exclusive_ram_id: code
    type: code
    bss_size: 0x0 # unknown
    start: 0xB8F50
    vram: 0x8029E750
    subsegments:
    - [0xB8F50, bin]

  - name: rsp_area_data
    exclusive_ram_id: code
    type: code
    bss_size: 0x0 # unknown
    start: 0xBF840
    vram: 0x802A5040
    subsegments:
    - [0xBF840, bin]

  - name: overlay_tables_data
    exclusive_ram_id: code
    type: bin
    bss_size: 0x0 # unknown
    start: 0x120000
    vram: 0x80F00000 # TODO
    subsegments:
    - [0x120000, bin] # overlay table 1
    - [0x140000, bin] # overlay table 2
    - [0x160000, bin] # overlay table 3
    - [0x180000, bin] # overlay table 4
    - [0x1A0000, bin] # overlay table 5
    - [0x1C0000, bin] # overlay table 6
    - [0x1E0000, bin] # overlay table 7
    - [0x200000, bin] # overlay table 8
    - [0x240000, bin] # overlay table 9
    - [0x260000, bin] # overlay table 10
    - [0x280000, bin] # overlay table 11
    - [0x2A0000, bin] # overlay table 12
    - [0x2C0000, bin] # overlay table 13
    - [0x2E0000, bin] # overlay table 14
    - [0x300000, bin] # rest of regular ROM, pre decompressed area

  - name: overlay_1_header
    exclusive_ram_id: overlay
    type: data
    bss_size: 0x0 # unknown
    start: 0x800000
    vram: 0x80008000
    subsegments:
    - [0x800000, data]

  - name: overlay_1_subovl_1
    exclusive_ram_id: overlay
    ld_use_symbolic_vram_addresses: false
    type: code
    dir: overlays/ovl_1
    bss_size: 0x0 # unknown
    start: 0x800010
    vram: 0x80043000
    follows_vram: main_code
    symbol_name_format: ovl1_$VRAM
    subsegments:
    - [0x800010, asm]

  - name: overlay_1_subovl_2
    exclusive_ram_id: overlay
    type: code
    dir: overlays/ovl_2
    bss_size: 0x0 # unknown
    start: 0x8019F0
    vram: 0x80043000
    follows_vram: main_code
    symbol_name_format: ovl2_$VRAM
    subsegments:
    - [0x8019F0, asm]

  - name: overlay_1_subovl_3
    exclusive_ram_id: overlay
    type: code
    dir: overlays/ovl_3
    bss_size: 0x0 # unknown
    start: 0x8034C0
    vram: 0x80043000
    follows_vram: main_code
    symbol_name_format: ovl3_$VRAM
    subsegments:
    - [0x8034C0, asm]

  - [0x806950, bin]
  - [0xC00000]
